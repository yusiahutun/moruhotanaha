<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=robots content="index,follow,noarchive"><title>How to Use Docker Restart Policies to Keep Containers Running - JBlogZ</title><meta name=description content="Docker gives you several options to manage your container's lifecycle. Containers do not normally restart automatically after they terminate. With restart policies, you can take control over individual container lifecycles."><meta name=author content="Some Person"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"JBlogZ","url":"\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"\/how-to-use-docker-restart-policies-to-keep-containers-running.html","name":"How to use docker restart policies to keep containers running"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Jenniffer Sheldon"},"headline":"How to Use Docker Restart Policies to Keep Containers Running","description":"Docker gives you several options to manage your container\u0027s lifecycle. Containers do not normally restart automatically after they terminate. With restart policies, you can take control over individual container lifecycles.","inLanguage":"en","wordCount":865,"datePublished":"2024-04-07T00:00:00","dateModified":"2024-04-07T00:00:00","image":"\/img\/avatar-icon.png","keywords":[""],"mainEntityOfPage":"\/how-to-use-docker-restart-policies-to-keep-containers-running.html","publisher":{"@type":"Organization","name":"\/","logo":{"@type":"ImageObject","url":"\/img\/avatar-icon.png","height":60,"width":60}}}</script><meta property="og:title" content="How to Use Docker Restart Policies to Keep Containers Running"><meta property="og:description" content="Docker gives you several options to manage your container's lifecycle. Containers do not normally restart automatically after they terminate. With restart policies, you can take control over individual container lifecycles."><meta property="og:image" content="/img/avatar-icon.png"><meta property="og:url" content="/how-to-use-docker-restart-policies-to-keep-containers-running.html"><meta property="og:type" content="website"><meta property="og:site_name" content="JBlogZ"><meta name=twitter:title content="How to Use Docker Restart Policies to Keep Containers Running"><meta name=twitter:description content="Docker gives you several options to manage your container's lifecycle. Containers do not normally restart automatically after they terminate. With restart policies, you can take control over â€¦"><meta name=twitter:image content="/img/avatar-icon.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@username"><meta name=twitter:creator content="@username"><link href=./img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.98.0"><link rel=alternate href=./index.xml type=application/rss+xml title=JBlogZ><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/highlight.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>How to Use Docker Restart Policies to Keep Containers Running</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on April 7, 2024
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;865&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Jenniffer Sheldon</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>Available Policies</a></li></ul><ul class=table-content-level-1><li><a href=#>Applying a Restart Policy</a></li></ul><ul class=table-content-level-1><li><a href=#>Restart Loops</a></li></ul><ul class=table-content-level-1><li><a href=#>Limiting Restart Retries</a></li></ul><ul class=table-content-level-1><li><a href=#>Investigating Why Containers Stopped</a></li></ul><ul class=table-content-level-1><li><a href=#>Summary</a></li></ul><p>Docker gives you several options to manage your container's lifecycle. Containers do not normally restart automatically after they terminate. With restart policies, you can take control over individual container lifecycles.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Restart policies will be used whenever a container stops running. Docker also looks at restart policies when the daemon starts up. You can use this mechanism to bring containers up with your host after reboots.</p><h2 id=available-policies>Available Policies</h2><p>There are currently four different <a href=#>restart policies</a>:</p><ul><li><strong><code>no</code></strong> - This policy will never automatically start a container. This is the default policy for all containers created with<pre><code class=hljs>docker run</code> </pre>.</li><li><strong><pre><code class=hljs>always</code> </pre></strong>- Docker will ensure the container is always running. If the container stops, it will be immediately restarted. You can still manually stop the container with <code>docker stop</code> but Docker will bring it back up next time the daemon restarts.</li><li><strong><code>on-failure</code></strong> - The container will get restarted if it stops because of an error. Docker won't bring the container up after the daemon restarts.</li><li><strong><pre><code class=hljs>unless-stopped</code> </pre></strong>- This functions similarly to<pre><code class=hljs>always</code> </pre>. The difference is that Docker won't ever restart the container if it has been manually stopped.</li></ul><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>You'll typically use one of the last three options for production workloads. As Docker containers are often used for long-running background services, you usually want them to restart whenever anything goes wrong. The <code>no</code> policy is best suited to local development use. It's also useful for utility containers which run a single executable and then terminate.</p><p>It can be difficult to decide which restart policy to use.</p><pre><code class=hljs>always</code> </pre><p>is often the most natural choice but the daemon restart behaviour can easily be overlooked. If you want containers to reliably stay stopped after you've run <code>docker stop</code>, you should use</p><pre><code class=hljs>unless-stopped</code> </pre><p>.</p><p>Docker detects errors based on the exit code emitted from the container's foreground process. An exit code of</p><pre><code class=hljs>1</code> </pre><p>or higher is interpreted as an error. This matches the Unix handling of exit codes, where only</p><pre><code class=hljs>0</code> </pre><p>represents a successful execution.</p><p>When Docker restarts your container, it's equivalent to running</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class=hljs>docker run</code> </pre><p>again. That means the image's</p><pre><code class=hljs>ENTRYPOINT</code> </pre><p>script will be invoked. Bootstrap systems should always be resilient to multiple invocations.</p><h2 id=applying-a-restart-policy>Applying a Restart Policy</h2><p>You can start a container with a specific restart policy by passing the</p><pre><code class="hljs sql"><span class=hljs-comment>--restart</span></code> </pre><p>flag to</p><pre><code class=hljs>docker run</code> </pre><p>:</p><pre>docker run --name httpd --restart always httpd:latest</pre><p>If you're using Docker Compose, add the <code>restart</code> field to your <code>docker-compose.yml</code>:</p><pre>services:  <p> httpd:</p>  <p> image: httpd:latest</p>  <p> restart: always</p></pre><p>You can change the restart policy of an existing container using <code>docker update</code>. Pass the name of the container to the command. You can find container names by running <code>docker ps -a</code>.</p><pre>docker update --restart-policy unless-stopped httpd</pre><p>You can use <code>docker update</code> with containers that are running or stopped.</p><h2 id=restart-loops>Restart Loops</h2><p>Docker includes a couple of safeguards against perpetual restart loops. The first is a mandatory time delay before restart policies activate. Docker won't begin monitoring restarts until a container has been running for at least 10 seconds. This prevents a failed container from continually restarting.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The other specialist behaviour concerns the <code>docker stop</code> command. Docker will always respect use of <code>docker stop</code>, so the container won't immediately restart after you run the command. If you actually want to restart the container, use <code>docker restart</code> instead.</p><h2 id=limiting-restart-retries>Limiting Restart Retries</h2><p>The <code>on-failure</code> restart policy lets you specify how many retries should be attempted. Docker will give up and leave the container in a stopped state if it fails to start multiple times in succession.</p><pre>docker run httpd:latest --restart on-failure:5</pre><p>In this example, Docker will try to restart the container five times after a failure (non-zero exit code). If the container fails to start on the fifth attempt, no more retries will be attempted. This option is useful for containers where a persistent starting error is unlikely to be resolved without manual intervention.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=investigating-why-containers-stopped>Investigating Why Containers Stopped</h2><p>If you need to know why a container stopped, run <code>docker ps -a</code>. This will show the details of all your containers, whether stopped or running. Find the target container and look in its "Status" column. For stopped containers, the exit code will be shown in brackets. If the code is greater than zero, the container terminated due to an error.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/04/e5c169a4.png><p>You'd need to refer to the documentation for the process running in the container to determine the meanings of individual error codes. However, you can often get insights into what caused a crash by retrieving the container's logs. Logs remain available after a container is stopped.</p><pre>docker logs my-container</pre><p>The log stream aggregates the container's standard output and standard error streams. If the error's been logged, you should expect to see it in the last few lines of output.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=summary>Summary</h2><p>Restart policies help ensure your Docker containers are there when you need them. The default <code>no</code> policy is unsuitable for most production workloads. You don't want your containers to stay stopped if they crash!</p><p>Use of one of the three restart-capable policies makes your containers more resilient to hardware reboots and unexpected termination. Docker will maintain service availability in the event of a container crash.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBwtM6wZK2nXarApnnDqJqknaJiv6a%2F05qprWWgpLmqr8ieqmasn2K4prHPZpqopqSWtq%2Bx0axkq62eo7avs44%3D</p><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html&text=How%20to%20Use%20Docker%20Restart%20Policies%20to%20Keep%20Containers%20Running&via=username" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html&title=How%20to%20Use%20Docker%20Restart%20Policies%20to%20Keep%20Containers%20Running" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html&title=How%20to%20Use%20Docker%20Restart%20Policies%20to%20Keep%20Containers%20Running" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html&title=How%20to%20Use%20Docker%20Restart%20Policies%20to%20Keep%20Containers%20Running" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=%2fhow-to-use-docker-restart-policies-to-keep-containers-running.html&description=How%20to%20Use%20Docker%20Restart%20Policies%20to%20Keep%20Containers%20Running" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section></article><ul class="pager blog-pager"><li class=previous><a href=./cleft-lip-dermal-filler-treatment-tried-and-tested.html data-toggle=tooltip data-placement=top title="I cried tears of joy after having treatment for my cleft lip in my thirties">&larr; Previous Post</a></li><li class=next><a href=./requested-value-cannot-be-determined-error-windows.html data-toggle=tooltip data-placement=top title="How to Fix the The Requested Value Cannot Be Determined Error on Windows">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">All rights reserved
&nbsp;&bull;&nbsp;&copy;
2024
&nbsp;&bull;&nbsp;
<a href=./>JBlogZ</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.98.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script>
<script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://assets.cdnweb.info/hugo/bh/js/main.js></script>
<script src=https://assets.cdnweb.info/hugo/bh/js/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script>renderMathInElement(document.body)</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://assets.cdnweb.info/hugo/bh/js/load-photoswipe.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>